<!doctype html>
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Gestión de Quejas | FMH UNACH</title>
    <!--begin::Primary Meta Tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="Gestión de Quejas | FMH UNACH" />
    <meta name="author" content="ColorlibHQ" />
    <meta
      name="description"
      content="AdminLTE is a Free Bootstrap 5 Admin Dashboard, 30 example pages using Vanilla JS."
    />
    <meta
      name="keywords"
      content="bootstrap 5, bootstrap, bootstrap 5 admin dashboard, bootstrap 5 dashboard, bootstrap 5 charts, bootstrap 5 calendar, bootstrap 5 datepicker, bootstrap 5 tables, bootstrap 5 datatable, vanilla js datatable, colorlibhq, colorlibhq dashboard, colorlibhq admin dashboard"
    />
    <!--end::Primary Meta Tags-->
    <!--begin::Fonts-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css"
      integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q="
      crossorigin="anonymous"
    />
    <!--end::Fonts-->
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css"
      integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg="
      crossorigin="anonymous"
    />
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    <!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI="
      crossorigin="anonymous"
    />
    <!--end::Third Party Plugin(Bootstrap Icons)-->
    <!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="../../../dist/css/adminlte.css" />
    <!--end::Required Plugin(AdminLTE)-->
    <meta charset="UTF-8" />
  </head>
  <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <div class="app-wrapper">
      <!--begin::Header-->
      <nav class="app-header navbar navbar-expand" style="background-color: #192d63">
        <div class="container-fluid">
          <div class="d-flex align-items-center w-100">
            <img
              src="../../../dist/img/logo-unach-azul.png"
              alt="Logo UNACH"
              style="max-width: 48px; margin-right: 16px"
            />
            <div class="flex-grow-1 text-center">
              <span class="fw-bold" style="color: #d4b012; font-size: 1.3rem"
                >Facultad de Medicina Humana "Dr. Manuel Velasco Suárez"</span
              ><br />
              <span class="fw-light text-white" style="font-size: 1rem"
                >Educación que transforma</span
              >
            </div>
            <div class="d-flex align-items-center">
              <a
                href="../../../dist/pages/admin/login.html"
                class="btn btn-outline-light btn-sm me-2"
                style="border-color: #d4b012; color: #d4b012"
              >
                <i class="bi bi-shield-lock me-1"></i>Administración
              </a>
              <img
                src="../../../dist/img/jubileo50.png"
                alt="Jubileo 50 años"
                style="max-width: 48px; margin-left: 16px"
              />
            </div>
          </div>
        </div>
      </nav>
      <!--end::Header-->
      <!--begin::Sidebar-->
      <aside
        class="app-sidebar bg-body-secondary shadow"
        data-bs-theme="dark"
        style="background-color: #192d63"
      >
        <!--begin::Sidebar Brand-->
        <div class="sidebar-brand">
          <a href="/admin/dashboard" class="brand-link">
            <img
              src="../../../dist/img/logo-unach-azul.png"
              alt="Logo UNACH"
              class="brand-image opacity-75 shadow"
            />
            <span class="brand-text fw-bold" style="color: #d4b012">ADMIN UNACH</span>
          </a>
        </div>
        <!--end::Sidebar Brand-->
        <div class="sidebar-wrapper">
          <nav class="mt-2">
            <ul class="nav sidebar-menu flex-column" role="menu">
              <li class="nav-item">
                <a href="/admin/dashboard" class="nav-link">
                  <i class="nav-icon bi bi-speedometer2" style="color: #d4b012"></i>
                  <p>Dashboard</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/quejas" class="nav-link active">
                  <i class="nav-icon bi bi-exclamation-triangle-fill" style="color: #d4b012"></i>
                  <p>Gestión de Quejas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/sugerencias" class="nav-link">
                  <i class="nav-icon bi bi-lightbulb-fill" style="color: #d4b012"></i>
                  <p>Gestión de Sugerencias</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/reconocimientos" class="nav-link">
                  <i class="nav-icon bi bi-star-fill" style="color: #d4b012"></i>
                  <p>Gestión de Reconocimientos</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/usuarios" class="nav-link">
                  <i class="nav-icon bi bi-people-fill" style="color: #d4b012"></i>
                  <p>Gestión de Usuarios</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/reportes" class="nav-link">
                  <i class="nav-icon bi bi-graph-up" style="color: #d4b012"></i>
                  <p>Reportes y Estadísticas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/configuracion" class="nav-link">
                  <i class="nav-icon bi bi-gear-fill" style="color: #d4b012"></i>
                  <p>Configuración</p>
                </a>
              </li>
              <hr style="border-color: #d4b012; opacity: 0.3" />
              <li class="nav-item">
                <a href="/" class="nav-link">
                  <i class="nav-icon bi bi-house-door-fill" style="color: #d4b012"></i>
                  <p>Volver al Sitio</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link" id="logoutBtn">
                  <i class="nav-icon bi bi-box-arrow-right" style="color: #d4b012"></i>
                  <p>Cerrar Sesión</p>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </aside>
      <!--end::Sidebar-->
      <script type="module">
        document.getElementById('logoutBtn').addEventListener('click', function (e) {
          e.preventDefault(),
            confirm('¿Estás seguro de que quieres cerrar sesión?') &&
              (localStorage.removeItem('adminLoggedIn'),
              localStorage.removeItem('adminUser'),
              (window.location.href = '/admin/login'));
        });
      </script>
      <main class="app-main">
        <div class="app-content-header">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col-md-2 text-center mb-2 mb-md-0">
                <img
                  src="/dist/img/logo-unach-azul.png"
                  alt="Logo UNACH"
                  style="max-width: 100px"
                />
              </div>
              <div class="col-md-8 text-center">
                <h2 class="mb-0">Gestión de Quejas</h2>
                <h5>Facultad de Medicina Humana "Dr. Manuel Velasco Suárez" Campus IV</h5>
              </div>
              <div class="col-md-2 text-center mb-2 mb-md-0">
                <img src="/dist/img/jubileo50.png" alt="Jubileo 50 años" style="max-width: 100px" />
              </div>
            </div>
          </div>
        </div>
        <div class="app-content">
          <div class="container-fluid">
            <!-- Filtros y Búsqueda -->
            <div class="card mb-4">
              <div class="card-header"><h5 class="card-title">Filtros y Búsqueda</h5></div>
              <div class="card-body">
                <div class="row g-3">
                  <div class="col-md-3">
                    <label for="searchInput" class="form-label">Buscar</label>
                    <input
                      type="text"
                      class="form-control"
                      id="searchInput"
                      placeholder="Buscar por folio, asunto..."
                    />
                  </div>
                  <div class="col-md-2">
                    <label for="statusFilter" class="form-label">Estado</label>
                    <select class="form-select" id="statusFilter">
                      <option value="">Todos</option>
                      <option value="Pendiente">Pendiente</option>
                      <option value="En Revisión">En Revisión</option>
                      <option value="Resuelto">Resuelto</option>
                      <option value="Rechazado">Rechazado</option>
                    </select>
                  </div>
                  <div class="col-md-2">
                    <label for="dateFilter" class="form-label">Fecha</label>
                    <select class="form-select" id="dateFilter">
                      <option value="">Todas</option>
                      <option value="today">Hoy</option>
                      <option value="week">Esta semana</option>
                      <option value="month">Este mes</option>
                    </select>
                  </div>
                  <div class="col-md-2">
                    <label for="priorityFilter" class="form-label">Prioridad</label>
                    <select class="form-select" id="priorityFilter">
                      <option value="">Todas</option>
                      <option value="Alta">Alta</option>
                      <option value="Media">Media</option>
                      <option value="Baja">Baja</option>
                    </select>
                  </div>
                  <div class="col-md-3 d-flex align-items-end">
                    <button class="btn btn-primary me-2" onclick="applyFilters()">
                      <i class="bi bi-search"></i> Filtrar
                    </button>
                    <button class="btn btn-secondary" onclick="clearFilters()">
                      <i class="bi bi-arrow-clockwise"></i> Limpiar
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- Tabla de Quejas -->
            <div class="card">
              <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="card-title">Lista de Quejas</h5>
                <div>
                  <button class="btn btn-success" onclick="exportToExcel()">
                    <i class="bi bi-file-earmark-excel"></i> Exportar
                  </button>
                  <button class="btn btn-primary" onclick="addNewComplaint()">
                    <i class="bi bi-plus-circle"></i> Nueva Queja
                  </button>
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped table-hover" id="quejasTable">
                    <thead>
                      <tr>
                        <th>Folio</th>
                        <th>Fecha</th>
                        <th>Remitente</th>
                        <th>Asunto</th>
                        <th>Prioridad</th>
                        <th>Estado</th>
                        <th>Asignado a</th>
                        <th>Acciones</th>
                      </tr>
                    </thead>
                    <tbody>
                      <!-- Se llenará dinámicamente -->
                    </tbody>
                  </table>
                </div>
                <!-- Paginación -->
                <nav aria-label="Paginación de quejas">
                  <ul class="pagination justify-content-center" id="pagination">
                    <!-- Se generará dinámicamente -->
                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </main>
      <!--begin::Footer-->
      <footer class="app-footer" style="background-color: #192d63; color: #d4b012; padding: 1rem 0">
        <div class="container-fluid text-center">
          <strong>
            &copy; 2025 Facultad de Medicina Humana “Dr. Manuel Velasco Suárez” - UNACH.<br />
            Carretera Puerto Madero Km. 10.5, Finca Santa Teresa, Tapachula, Chiapas, México | C.P.
            30825 | Tel: (961) 6178000 ext. 5695
          </strong>
          <div style="font-size: 0.9rem; color: #fff">Todos los derechos reservados.</div>
        </div>
      </footer>
      <!--end::Footer-->
      <!--begin::Third Party Plugin(OverlayScrollbars)-->
      <script
        src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/browser/overlayscrollbars.browser.es6.min.js"
        integrity="sha256-dghWARbRe2eLlIJ56wNB+b760ywulqK3DzZYEpsg2fQ="
        crossorigin="anonymous"
      ></script>
      <!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Required Plugin(popperjs for Bootstrap 5)-->
      <script
        src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"
      ></script>
      <!--end::Required Plugin(popperjs for Bootstrap 5)--><!--begin::Required Plugin(Bootstrap 5)-->
      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"
      ></script>
      <!--end::Required Plugin(Bootstrap 5)--><!--begin::Required Plugin(AdminLTE)-->
      <script src="../../../dist/js/adminlte.js"></script>
      <!--end::Required Plugin(AdminLTE)--><!--begin::OverlayScrollbars Configure-->
      <script>
        const SELECTOR_SIDEBAR_WRAPPER = '.sidebar-wrapper';
        const Default = {
          scrollbarTheme: 'os-theme-light',
          scrollbarAutoHide: 'leave',
          scrollbarClickScroll: true,
        };
        document.addEventListener('DOMContentLoaded', function () {
          const sidebarWrapper = document.querySelector(SELECTOR_SIDEBAR_WRAPPER);
          if (sidebarWrapper && typeof OverlayScrollbarsGlobal?.OverlayScrollbars !== 'undefined') {
            OverlayScrollbarsGlobal.OverlayScrollbars(sidebarWrapper, {
              scrollbars: {
                theme: Default.scrollbarTheme,
                autoHide: Default.scrollbarAutoHide,
                clickScroll: Default.scrollbarClickScroll,
              },
            });
          }
        });
      </script>
      <!--end::OverlayScrollbars Configure-->
    </div>
    <!-- Modal para Ver/Editar Queja -->
    <div class="modal fade" id="quejaModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalTitle">Detalles de la Queja</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="quejaForm">
              <div class="row g-3">
                <div class="col-md-6">
                  <label class="form-label">Folio</label>
                  <input type="text" class="form-control" id="modalFolio" readonly />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Fecha de Recepción</label>
                  <input type="text" class="form-control" id="modalFecha" readonly />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Remitente</label>
                  <input type="text" class="form-control" id="modalRemitente" />
                </div>
                <div class="col-md-6">
                  <label class="form-label">Correo</label>
                  <input type="email" class="form-control" id="modalCorreo" />
                </div>
                <div class="col-12">
                  <label class="form-label">Asunto</label>
                  <input type="text" class="form-control" id="modalAsunto" />
                </div>
                <div class="col-12">
                  <label class="form-label">Descripción</label>
                  <textarea class="form-control" id="modalDescripcion" rows="4"></textarea>
                </div>
                <div class="col-md-4">
                  <label class="form-label">Estado</label>
                  <select class="form-select" id="modalEstado">
                    <option value="Pendiente">Pendiente</option>
                    <option value="En Revisión">En Revisión</option>
                    <option value="Resuelto">Resuelto</option>
                    <option value="Rechazado">Rechazado</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">Prioridad</label>
                  <select class="form-select" id="modalPrioridad">
                    <option value="Alta">Alta</option>
                    <option value="Media">Media</option>
                    <option value="Baja">Baja</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">Asignado a</label>
                  <select class="form-select" id="modalAsignado">
                    <option value="">Sin asignar</option>
                    <option value="Dr. García">Dr. García</option>
                    <option value="Lic. Martínez">Lic. Martínez</option>
                    <option value="Ing. López">Ing. López</option>
                  </select>
                </div>
                <div class="col-12">
                  <label class="form-label">Comentarios del Administrador</label>
                  <textarea
                    class="form-control"
                    id="modalComentarios"
                    rows="3"
                    placeholder="Agregar comentarios sobre el seguimiento..."
                  ></textarea>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            <button type="button" class="btn btn-primary" onclick="saveQueja()">
              Guardar Cambios
            </button>
          </div>
        </div>
      </div>
    </div>
    <script type="module">
      localStorage.getItem('adminLoggedIn') || (window.location.href = 'login.html');
      let n = [
        {
          folio: 'QJ-2024-001',
          fecha: '2024-01-20',
          remitente: 'Anónimo',
          correo: 'anonimo@ejemplo.com',
          asunto: 'Problema con el aire acondicionado',
          descripcion:
            'El aire acondicionado del salón 101 no funciona correctamente desde hace 3 días.',
          prioridad: 'Alta',
          estado: 'Pendiente',
          asignado: '',
          comentarios: '',
        },
        {
          folio: 'QJ-2024-002',
          fecha: '2024-01-19',
          remitente: 'María López',
          correo: 'maria.lopez@ejemplo.com',
          asunto: 'Falta de material en laboratorio',
          descripcion:
            'No hay suficientes microscopios disponibles para la práctica de histología.',
          prioridad: 'Media',
          estado: 'En Revisión',
          asignado: 'Dr. García',
          comentarios: 'Se está gestionando la compra de nuevos microscopios.',
        },
        {
          folio: 'QJ-2024-003',
          fecha: '2024-01-18',
          remitente: 'Carlos Ruiz',
          correo: 'carlos.ruiz@ejemplo.com',
          asunto: 'Problema de iluminación en pasillos',
          descripcion:
            'Los pasillos del segundo piso tienen poca iluminación, especialmente por las noches.',
          prioridad: 'Baja',
          estado: 'Resuelto',
          asignado: 'Ing. López',
          comentarios: 'Se han reemplazado las lámparas defectuosas.',
        },
      ];
      t();
      function t() {
        const a = document.querySelector('#quejasTable tbody');
        (a.innerHTML = ''),
          n.forEach((e) => {
            const o = document.createElement('tr');
            (o.innerHTML = `
            <td><strong>${e.folio}</strong></td>
            <td>${e.fecha}</td>
            <td>${e.remitente}</td>
            <td>${e.asunto}</td>
            <td><span class="badge ${i(e.prioridad)}">${e.prioridad}</span></td>
            <td><span class="badge ${s(e.estado)}">${e.estado}</span></td>
            <td>${e.asignado || 'Sin asignar'}</td>
            <td>
              <button class="btn btn-sm btn-primary" onclick="viewQueja('${e.folio}')">
                <i class="bi bi-eye"></i>
              </button>
              <button class="btn btn-sm btn-success" onclick="editQueja('${e.folio}')">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="btn btn-sm btn-danger" onclick="deleteQueja('${e.folio}')">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          `),
              a.appendChild(o);
          });
      }
      function i(a) {
        switch (a) {
          case 'Alta':
            return 'bg-danger';
          case 'Media':
            return 'bg-warning';
          case 'Baja':
            return 'bg-success';
          default:
            return 'bg-secondary';
        }
      }
      function s(a) {
        switch (a) {
          case 'Pendiente':
            return 'bg-warning';
          case 'En Revisión':
            return 'bg-info';
          case 'Resuelto':
            return 'bg-success';
          case 'Rechazado':
            return 'bg-danger';
          default:
            return 'bg-secondary';
        }
      }
    </script>
  </body>
</html>
