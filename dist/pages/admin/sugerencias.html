<!doctype html>
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Gestión de Sugerencias | FMH UNACH</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="Gestión de Sugerencias | FMH UNACH" />
    <meta name="description" content="Panel de administración para gestionar sugerencias de la comunidad universitaria" />
    
    <!--begin::Fonts-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css" integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q=" crossorigin="anonymous" />
    <!--end::Fonts-->
    
    <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css" integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg=" crossorigin="anonymous" />
    <!--end::Third Party Plugin(OverlayScrollbars)-->
    
    <!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI=" crossorigin="anonymous" />
    <!--end::Third Party Plugin(Bootstrap Icons)-->
    
    <!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="../../css/adminlte.css" />
    <!--end::Required Plugin(AdminLTE)-->
    
    <meta charset="UTF-8" />
  </head>
  <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <div class="app-wrapper">
      <!--begin::Header-->
      <nav class="app-header navbar navbar-expand" style="background-color: #192d63">
        <div class="container-fluid">
          <div class="d-flex align-items-center w-100">
            <img src="../../assets/img/AdminLTELogo.png" alt="Logo UNACH" style="max-width: 48px; margin-right: 16px" />
            <div class="flex-grow-1 text-center">
              <span class="fw-bold" style="color: #d4b012; font-size: 1.3rem">Facultad de Medicina Humana "Dr. Manuel Velasco Suárez"</span><br />
              <span class="fw-light text-white" style="font-size: 1rem">Educación que transforma</span>
            </div>
            <div class="d-flex align-items-center">
              <a href="login.html" class="btn btn-outline-light btn-sm me-2" style="border-color: #d4b012; color: #d4b012">
                <i class="bi bi-shield-lock me-1"></i>Administración
              </a>
              <img src="../../assets/img/AdminLTELogo.png" alt="Logo Admin" style="max-width: 48px; margin-left: 16px" />
            </div>
          </div>
        </div>
      </nav>
      <!--end::Header-->
      
      <!--begin::Sidebar-->
      <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark" style="background-color: #192d63">
        <!--begin::Sidebar Brand-->
        <div class="sidebar-brand">
          <a href="/admin/dashboard" class="brand-link">
            <img src="../../../dist/img/logo-unach-azul.png" alt="Logo UNACH" class="brand-image opacity-75 shadow" />
            <span class="brand-text fw-bold" style="color: #d4b012">ADMIN UNACH</span>
          </a>
        </div>
        <!--end::Sidebar Brand-->
        
        <div class="sidebar-wrapper">
          <nav class="mt-2">
            <ul class="nav sidebar-menu flex-column" role="menu">
              <li class="nav-item">
                <a href="/admin/dashboard" class="nav-link">
                  <i class="nav-icon bi bi-speedometer2" style="color: #d4b012"></i>
                  <p>Dashboard</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/quejas" class="nav-link">
                  <i class="nav-icon bi bi-exclamation-triangle-fill" style="color: #d4b012"></i>
                  <p>Gestión de Quejas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/sugerencias" class="nav-link active">
                  <i class="nav-icon bi bi-lightbulb-fill" style="color: #d4b012"></i>
                  <p>Gestión de Sugerencias</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/reconocimientos" class="nav-link">
                  <i class="nav-icon bi bi-star-fill" style="color: #d4b012"></i>
                  <p>Gestión de Reconocimientos</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/usuarios" class="nav-link">
                  <i class="nav-icon bi bi-people-fill" style="color: #d4b012"></i>
                  <p>Gestión de Usuarios</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/reportes" class="nav-link">
                  <i class="nav-icon bi bi-graph-up" style="color: #d4b012"></i>
                  <p>Reportes y Estadísticas</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="/admin/configuracion" class="nav-link">
                  <i class="nav-icon bi bi-gear-fill" style="color: #d4b012"></i>
                  <p>Configuración</p>
                </a>
              </li>
              <hr style="border-color: #d4b012; opacity: 0.3" />
              <li class="nav-item">
                <a href="/" class="nav-link">
                  <i class="nav-icon bi bi-house-door-fill" style="color: #d4b012"></i>
                  <p>Volver al Sitio</p>
                </a>
              </li>
              <li class="nav-item">
                <a href="#" class="nav-link" id="logoutBtn">
                  <i class="nav-icon bi bi-box-arrow-right" style="color: #d4b012"></i>
                  <p>Cerrar Sesión</p>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </aside>
      <!--end::Sidebar-->
      
      <main class="app-main">
        <div class="app-content-header">
          <div class="container-fluid">
            <div class="row align-items-center">
              <div class="col-md-2 text-center mb-2 mb-md-0">
                <img src="/dist/img/logo-unach-azul.png" alt="Logo UNACH" style="max-width: 100px" />
              </div>
              <div class="col-md-8 text-center">
                <h2 class="mb-0">Gestión de Sugerencias</h2>
                <h5>Facultad de Medicina Humana "Dr. Manuel Velasco Suárez" Campus IV</h5>
              </div>
              <div class="col-md-2 text-center mb-2 mb-md-0">
                <img src="/dist/img/jubileo50.png" alt="Jubileo 50 años" style="max-width: 100px" />
              </div>
            </div>
          </div>
        </div>
        
        <div class="app-content">
          <div class="container-fluid">
            <!-- Filtros y Búsqueda -->
            <div class="row mb-4">
              <div class="col-md-8">
                <div class="input-group">
                  <input type="text" class="form-control" placeholder="Buscar sugerencias..." id="searchInput">
                  <button class="btn btn-outline-secondary" type="button" id="searchBtn">
                    <i class="bi bi-search"></i>
                  </button>
                </div>
              </div>
              <div class="col-md-4">
                <select class="form-select" id="statusFilter">
                  <option value="">Todos los estados</option>
                  <option value="Pendiente">Pendiente</option>
                  <option value="En Revisión">En Revisión</option>
                  <option value="Aprobada">Aprobada</option>
                  <option value="Implementada">Implementada</option>
                  <option value="Rechazada">Rechazada</option>
                </select>
              </div>
            </div>
            
            <!-- Estadísticas Rápidas -->
            <div class="row g-4 mb-4">
              <div class="col-xl-3 col-md-6">
                <div class="card bg-primary text-white">
                  <div class="card-body">
                    <div class="d-flex justify-content-between">
                      <div>
                        <h3 class="mb-0" id="totalSugerencias">0</h3>
                        <p class="mb-0">Total Sugerencias</p>
                      </div>
                      <div class="align-self-center">
                        <i class="bi bi-lightbulb-fill fs-1"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-md-6">
                <div class="card bg-warning text-white">
                  <div class="card-body">
                    <div class="d-flex justify-content-between">
                      <div>
                        <h3 class="mb-0" id="pendientes">0</h3>
                        <p class="mb-0">Pendientes</p>
                      </div>
                      <div class="align-self-center">
                        <i class="bi bi-clock-fill fs-1"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-md-6">
                <div class="card bg-success text-white">
                  <div class="card-body">
                    <div class="d-flex justify-content-between">
                      <div>
                        <h3 class="mb-0" id="implementadas">0</h3>
                        <p class="mb-0">Implementadas</p>
                      </div>
                      <div class="align-self-center">
                        <i class="bi bi-check-circle-fill fs-1"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-3 col-md-6">
                <div class="card bg-info text-white">
                  <div class="card-body">
                    <div class="d-flex justify-content-between">
                      <div>
                        <h3 class="mb-0" id="enRevision">0</h3>
                        <p class="mb-0">En Revisión</p>
                      </div>
                      <div class="align-self-center">
                        <i class="bi bi-eye-fill fs-1"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Tabla de Sugerencias -->
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Lista de Sugerencias</h5>
                <div class="card-tools">
                  <button class="btn btn-success btn-sm" data-bs-toggle="modal" data-bs-target="#addSugerenciaModal">
                    <i class="bi bi-plus-circle me-1"></i>Nueva Sugerencia
                  </button>
                </div>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped" id="sugerenciasTable">
                    <thead>
                      <tr>
                        <th>Folio</th>
                        <th>Fecha</th>
                        <th>Remitente</th>
                        <th>Categoría</th>
                        <th>Asunto</th>
                        <th>Estado</th>
                        <th>Prioridad</th>
                        <th>Acciones</th>
                      </tr>
                    </thead>
                    <tbody id="sugerenciasTableBody">
                      <!-- Se llenará dinámicamente -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
      
      <!--begin::Footer-->
      <footer class="app-footer" style="background-color: #192d63; color: #d4b012; padding: 1rem 0">
        <div class="container-fluid text-center">
          <strong>
            &copy; 2025 Facultad de Medicina Humana "Dr. Manuel Velasco Suárez" - UNACH.<br />
            Carretera Puerto Madero Km. 10.5, Finca Santa Teresa, Tapachula, Chiapas, México | C.P.
            30825 | Tel: (961) 6178000 ext. 5695
          </strong>
          <div style="font-size: 0.9rem; color: #fff">Todos los derechos reservados.</div>
        </div>
      </footer>
      <!--end::Footer-->
    </div>
    
    <!-- Modal para Nueva Sugerencia -->
    <div class="modal fade" id="addSugerenciaModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Nueva Sugerencia</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="addSugerenciaForm">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Remitente</label>
                    <input type="text" class="form-control" id="remitente" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Categoría</label>
                    <select class="form-select" id="categoria" required>
                      <option value="">Seleccionar categoría</option>
                      <option value="Infraestructura">Infraestructura</option>
                      <option value="Académico">Académico</option>
                      <option value="Servicios">Servicios</option>
                      <option value="Tecnología">Tecnología</option>
                      <option value="Otros">Otros</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Asunto</label>
                <input type="text" class="form-control" id="asunto" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Descripción</label>
                <textarea class="form-control" id="descripcion" rows="4" required></textarea>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Prioridad</label>
                    <select class="form-select" id="prioridad" required>
                      <option value="Baja">Baja</option>
                      <option value="Media">Media</option>
                      <option value="Alta">Alta</option>
                      <option value="Crítica">Crítica</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Estado</label>
                    <select class="form-select" id="estado" required>
                      <option value="Pendiente">Pendiente</option>
                      <option value="En Revisión">En Revisión</option>
                      <option value="Aprobada">Aprobada</option>
                      <option value="Implementada">Implementada</option>
                      <option value="Rechazada">Rechazada</option>
                    </select>
                  </div>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" id="saveSugerenciaBtn">Guardar Sugerencia</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Modal para Ver/Editar Sugerencia -->
    <div class="modal fade" id="editSugerenciaModal" tabindex="-1">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Editar Sugerencia</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <form id="editSugerenciaForm">
              <input type="hidden" id="editId">
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Remitente</label>
                    <input type="text" class="form-control" id="editRemitente" required>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Categoría</label>
                    <select class="form-select" id="editCategoria" required>
                      <option value="Infraestructura">Infraestructura</option>
                      <option value="Académico">Académico</option>
                      <option value="Servicios">Servicios</option>
                      <option value="Tecnología">Tecnología</option>
                      <option value="Otros">Otros</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Asunto</label>
                <input type="text" class="form-control" id="editAsunto" required>
              </div>
              <div class="mb-3">
                <label class="form-label">Descripción</label>
                <textarea class="form-control" id="editDescripcion" rows="4" required></textarea>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Prioridad</label>
                    <select class="form-select" id="editPrioridad" required>
                      <option value="Baja">Baja</option>
                      <option value="Media">Media</option>
                      <option value="Alta">Alta</option>
                      <option value="Crítica">Crítica</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label">Estado</label>
                    <select class="form-select" id="editEstado" required>
                      <option value="Pendiente">Pendiente</option>
                      <option value="En Revisión">En Revisión</option>
                      <option value="Aprobada">Aprobada</option>
                      <option value="Implementada">Implementada</option>
                      <option value="Rechazada">Rechazada</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Comentarios del Administrador</label>
                <textarea class="form-control" id="editComentarios" rows="3" placeholder="Agregar comentarios sobre la sugerencia..."></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" id="updateSugerenciaBtn">Actualizar Sugerencia</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/browser/overlayscrollbars.browser.es6.min.js" integrity="sha256-dghWARbRe2eLlIJ56wNB+b760ywulqK3DzZYEpsg2fQ=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script src="../../../dist/js/adminlte.js"></script>
    
    <script>
      // Verificar autenticación
      if (!localStorage.getItem('adminLoggedIn')) {
        window.location.href = 'login.html';
      }
      
      // Datos simulados de sugerencias
      let sugerencias = [
        {
          id: 1,
          folio: 'SG-2024-001',
          fecha: '2024-01-20',
          remitente: 'María López',
          categoria: 'Infraestructura',
          asunto: 'Mejora en la biblioteca',
          descripcion: 'Sugiero agregar más mesas de estudio y mejorar la iluminación en la biblioteca.',
          estado: 'Pendiente',
          prioridad: 'Media',
          comentarios: ''
        },
        {
          id: 2,
          folio: 'SG-2024-002',
          fecha: '2024-01-19',
          remitente: 'Carlos Ruiz',
          categoria: 'Tecnología',
          asunto: 'WiFi en áreas comunes',
          descripcion: 'Sería muy útil tener WiFi gratuito en las áreas comunes del campus.',
          estado: 'En Revisión',
          prioridad: 'Alta',
          comentarios: 'En proceso de evaluación técnica'
        },
        {
          id: 3,
          folio: 'SG-2024-003',
          fecha: '2024-01-18',
          remitente: 'Ana Martínez',
          categoria: 'Académico',
          asunto: 'Nuevos horarios de consulta',
          descripcion: 'Sugiero extender los horarios de consulta para los estudiantes.',
          estado: 'Aprobada',
          prioridad: 'Media',
          comentarios: 'Aprobada por el comité académico'
        }
      ];
      
      // Función para renderizar la tabla
      function renderSugerencias(data = sugerencias) {
        const tbody = document.getElementById('sugerenciasTableBody');
        tbody.innerHTML = '';
        
        data.forEach(sugerencia => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${sugerencia.folio}</td>
            <td>${sugerencia.fecha}</td>
            <td>${sugerencia.remitente}</td>
            <td><span class="badge bg-info">${sugerencia.categoria}</span></td>
            <td>${sugerencia.asunto}</td>
            <td><span class="badge ${getEstadoBadgeClass(sugerencia.estado)}">${sugerencia.estado}</span></td>
            <td><span class="badge ${getPrioridadBadgeClass(sugerencia.prioridad)}">${sugerencia.prioridad}</span></td>
            <td>
              <button class="btn btn-sm btn-primary" onclick="viewSugerencia(${sugerencia.id})">
                <i class="bi bi-eye"></i>
              </button>
              <button class="btn btn-sm btn-success" onclick="editSugerencia(${sugerencia.id})">
                <i class="bi bi-pencil"></i>
              </button>
              <button class="btn btn-sm btn-danger" onclick="deleteSugerencia(${sugerencia.id})">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          `;
          tbody.appendChild(row);
        });
        
        updateStats();
      }
      
      // Función para obtener clase del badge de estado
      function getEstadoBadgeClass(estado) {
        switch(estado) {
          case 'Pendiente': return 'bg-warning';
          case 'En Revisión': return 'bg-info';
          case 'Aprobada': return 'bg-success';
          case 'Implementada': return 'bg-primary';
          case 'Rechazada': return 'bg-danger';
          default: return 'bg-secondary';
        }
      }
      
      // Función para obtener clase del badge de prioridad
      function getPrioridadBadgeClass(prioridad) {
        switch(prioridad) {
          case 'Baja': return 'bg-success';
          case 'Media': return 'bg-warning';
          case 'Alta': return 'bg-danger';
          case 'Crítica': return 'bg-dark';
          default: return 'bg-secondary';
        }
      }
      
      // Función para actualizar estadísticas
      function updateStats() {
        document.getElementById('totalSugerencias').textContent = sugerencias.length;
        document.getElementById('pendientes').textContent = sugerencias.filter(s => s.estado === 'Pendiente').length;
        document.getElementById('implementadas').textContent = sugerencias.filter(s => s.estado === 'Implementada').length;
        document.getElementById('enRevision').textContent = sugerencias.filter(s => s.estado === 'En Revisión').length;
      }
      
      // Función para ver sugerencia
      function viewSugerencia(id) {
        const sugerencia = sugerencias.find(s => s.id === id);
        if (sugerencia) {
          alert(`Viendo sugerencia: ${sugerencia.asunto}\n\nDescripción: ${sugerencia.descripcion}\n\nEstado: ${sugerencia.estado}\nPrioridad: ${sugerencia.prioridad}`);
        }
      }
      
      // Función para editar sugerencia
      function editSugerencia(id) {
        const sugerencia = sugerencias.find(s => s.id === id);
        if (sugerencia) {
          document.getElementById('editId').value = sugerencia.id;
          document.getElementById('editRemitente').value = sugerencia.remitente;
          document.getElementById('editCategoria').value = sugerencia.categoria;
          document.getElementById('editAsunto').value = sugerencia.asunto;
          document.getElementById('editDescripcion').value = sugerencia.descripcion;
          document.getElementById('editPrioridad').value = sugerencia.prioridad;
          document.getElementById('editEstado').value = sugerencia.estado;
          document.getElementById('editComentarios').value = sugerencia.comentarios;
          
          const modal = new bootstrap.Modal(document.getElementById('editSugerenciaModal'));
          modal.show();
        }
      }
      
      // Función para eliminar sugerencia
      function deleteSugerencia(id) {
        if (confirm('¿Estás seguro de que quieres eliminar esta sugerencia?')) {
          sugerencias = sugerencias.filter(s => s.id !== id);
          renderSugerencias();
        }
      }
      
      // Función para guardar nueva sugerencia
      document.getElementById('saveSugerenciaBtn').addEventListener('click', function() {
        const form = document.getElementById('addSugerenciaForm');
        if (form.checkValidity()) {
          const nuevaSugerencia = {
            id: sugerencias.length + 1,
            folio: `SG-2024-${String(sugerencias.length + 1).padStart(3, '0')}`,
            fecha: new Date().toISOString().split('T')[0],
            remitente: document.getElementById('remitente').value,
            categoria: document.getElementById('categoria').value,
            asunto: document.getElementById('asunto').value,
            descripcion: document.getElementById('descripcion').value,
            estado: document.getElementById('estado').value,
            prioridad: document.getElementById('prioridad').value,
            comentarios: ''
          };
          
          sugerencias.push(nuevaSugerencia);
          renderSugerencias();
          
          // Limpiar formulario y cerrar modal
          form.reset();
          const modal = bootstrap.Modal.getInstance(document.getElementById('addSugerenciaModal'));
          modal.hide();
          
          alert('Sugerencia guardada exitosamente');
        } else {
          form.reportValidity();
        }
      });
      
      // Función para actualizar sugerencia
      document.getElementById('updateSugerenciaBtn').addEventListener('click', function() {
        const form = document.getElementById('editSugerenciaForm');
        if (form.checkValidity()) {
          const id = parseInt(document.getElementById('editId').value);
          const index = sugerencias.findIndex(s => s.id === id);
          
          if (index !== -1) {
            sugerencias[index] = {
              ...sugerencias[index],
              remitente: document.getElementById('editRemitente').value,
              categoria: document.getElementById('editCategoria').value,
              asunto: document.getElementById('editAsunto').value,
              descripcion: document.getElementById('editDescripcion').value,
              prioridad: document.getElementById('editPrioridad').value,
              estado: document.getElementById('editEstado').value,
              comentarios: document.getElementById('editComentarios').value
            };
            
            renderSugerencias();
            
            // Cerrar modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('editSugerenciaModal'));
            modal.hide();
            
            alert('Sugerencia actualizada exitosamente');
          }
        } else {
          form.reportValidity();
        }
      });
      
      // Función de búsqueda
      document.getElementById('searchBtn').addEventListener('click', function() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const filtered = sugerencias.filter(s => 
          s.asunto.toLowerCase().includes(searchTerm) ||
          s.remitente.toLowerCase().includes(searchTerm) ||
          s.descripcion.toLowerCase().includes(searchTerm)
        );
        renderSugerencias(filtered);
      });
      
      // Filtro por estado
      document.getElementById('statusFilter').addEventListener('change', function() {
        const status = this.value;
        const filtered = status ? sugerencias.filter(s => s.estado === status) : sugerencias;
        renderSugerencias(filtered);
      });
      
      // Función de logout
      document.getElementById('logoutBtn').addEventListener('click', function(e) {
        e.preventDefault();
        if (confirm('¿Estás seguro de que quieres cerrar sesión?')) {
          localStorage.removeItem('adminLoggedIn');
          localStorage.removeItem('adminUser');
          window.location.href = 'login.html';
        }
      });
      
      // Inicializar la página
      document.addEventListener('DOMContentLoaded', function() {
        renderSugerencias();
      });
    </script>
  </body>
</html>
