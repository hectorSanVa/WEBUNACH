localStorage.getItem("adminLoggedIn")||(window.location.href="login.html");document.addEventListener("DOMContentLoaded",function(){a(),c()});function a(){document.getElementById("configGeneralForm").addEventListener("submit",function(e){e.preventDefault(),s()}),document.getElementById("configSistemaForm").addEventListener("submit",function(e){e.preventDefault(),r()}),document.getElementById("configEmailForm").addEventListener("submit",function(e){e.preventDefault(),d()}),document.getElementById("configApiForm").addEventListener("submit",function(e){e.preventDefault(),m()}),document.getElementById("guardarNotificacionesBtn").addEventListener("click",u),document.getElementById("limpiarCacheBtn").addEventListener("click",f),document.getElementById("optimizarBdBtn").addEventListener("click",l),document.getElementById("verificarSistemaBtn").addEventListener("click",g),document.getElementById("reiniciarSistemaBtn").addEventListener("click",E),document.getElementById("crearRespaldoBtn").addEventListener("click",p),document.getElementById("restaurarRespaldoBtn").addEventListener("click",I)}function c(){const e=JSON.parse(localStorage.getItem("configuracionSistema"))||{};e.notificaciones&&Object.keys(e.notificaciones).forEach(n=>{const i=document.getElementById(n);i&&(i.checked=e.notificaciones[n])})}function s(){const e=new FormData(document.getElementById("configGeneralForm")),n=Object.fromEntries(e.entries());localStorage.setItem("configuracionGeneral",JSON.stringify(n)),t("Configuración general guardada exitosamente","success")}function r(){const e=new FormData(document.getElementById("configSistemaForm")),n=Object.fromEntries(e.entries());localStorage.setItem("configuracionSistema",JSON.stringify(n)),t("Configuración del sistema guardada exitosamente","success")}function d(){const e=new FormData(document.getElementById("configEmailForm")),n=Object.fromEntries(e.entries());localStorage.setItem("configuracionEmail",JSON.stringify(n)),t("Configuración de email guardada exitosamente","success")}function m(){const e=new FormData(document.getElementById("configApiForm")),n=Object.fromEntries(e.entries());localStorage.setItem("configuracionApi",JSON.stringify(n)),t("Configuración de API guardada exitosamente","success")}function u(){const e={notifQuejasNuevas:document.getElementById("notifQuejasNuevas").checked,notifQuejasActualizadas:document.getElementById("notifQuejasActualizadas").checked,notifQuejasResueltas:document.getElementById("notifQuejasResueltas").checked,notifSugerenciasNuevas:document.getElementById("notifSugerenciasNuevas").checked,notifSugerenciasAprobadas:document.getElementById("notifSugerenciasAprobadas").checked,notifSugerenciasImplementadas:document.getElementById("notifSugerenciasImplementadas").checked,notifReconocimientosNuevos:document.getElementById("notifReconocimientosNuevos").checked,notifReconocimientosAprobados:document.getElementById("notifReconocimientosAprobados").checked,notifReconocimientosPublicados:document.getElementById("notifReconocimientosPublicados").checked};localStorage.setItem("configuracionNotificaciones",JSON.stringify(e)),t("Configuración de notificaciones guardada exitosamente","success")}function f(){confirm("¿Estás seguro de que quieres limpiar el cache del sistema?")&&setTimeout(()=>{t("Cache limpiado exitosamente","success")},1e3)}function l(){confirm("¿Estás seguro de que quieres optimizar la base de datos? Esto puede tomar varios minutos.")&&(t("Optimización de base de datos iniciada...","info"),setTimeout(()=>{t("Base de datos optimizada exitosamente","success")},3e3))}function g(){t("Verificación del sistema iniciada...","info"),setTimeout(()=>{const e=Math.floor(Math.random()*3);e===0?t("Sistema verificado. No se encontraron problemas.","success"):t(`Sistema verificado. Se encontraron ${e} problema(s) menor(es).`,"warning")},2e3)}function E(){confirm("¿Estás seguro de que quieres reiniciar el sistema? Esto cerrará todas las sesiones activas.")&&confirm("Esta acción es irreversible. ¿Confirmas el reinicio?")&&(t("Reinicio del sistema iniciado...","warning"),setTimeout(()=>{alert("El sistema se reiniciará en 5 segundos. Serás redirigido a la página de login.")},2e3))}function p(){confirm("¿Deseas crear un respaldo manual del sistema?")&&(t("Creando respaldo del sistema...","info"),setTimeout(()=>{t("Respaldo creado exitosamente. Archivo: respaldo_"+new Date().toISOString().split("T")[0]+".zip","success")},3e3))}function I(){alert("Función de restauración implementada. En producción, esto permitiría seleccionar un archivo de respaldo para restaurar el sistema.")}function t(e,n){const i=document.createElement("div");i.className=`alert alert-${n} alert-dismissible fade show`,i.innerHTML=`
          ${e}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;const o=document.querySelector(".app-content");o.insertBefore(i,o.firstChild),setTimeout(()=>{i.parentNode&&i.remove()},5e3)}
